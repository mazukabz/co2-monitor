# CO2 Monitor v1.2.5

–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ CO2 —Å Telegram –±–æ—Ç–æ–º, –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞–º–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –æ—Ç—á—ë—Ç–∞–º–∏.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     MQTT      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Raspberry Pi   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   MQTT Broker    ‚îÇ
‚îÇ  + MH-Z19/DHT22 ‚îÇ               ‚îÇ   (Mosquitto)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                           ‚îÇ
                                           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê               ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Telegram Bot   ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ  MQTT Processor  ‚îÇ
‚îÇ  (aiogram 3.x)  ‚îÇ               ‚îÇ  (saves to DB)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                                 ‚îÇ
         ‚ñº                                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê               ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Scheduler     ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   PostgreSQL     ‚îÇ
‚îÇ (reports/alerts)‚îÇ               ‚îÇ   (telemetry)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

| –°–µ—Ä–≤–∏—Å | –ü–æ—Ä—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|------|----------|
| `co2_mqtt` | - | MQTT –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—é –≤ –ë–î |
| `co2_bot` | - | Telegram –±–æ—Ç + –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –æ—Ç—á—ë—Ç–æ–≤ |
| `co2_api` | 10900 | API –¥–ª—è OTA –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤ |
| `co2_db` | 10532 | PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö |
| `mqtt` | 10883 | MQTT –±—Ä–æ–∫–µ—Ä Mosquitto |

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### Telegram –±–æ—Ç

**–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**
–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –º–µ–Ω—é –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞ (4 –∫–Ω–æ–ø–∫–∏) + –∫–æ–º–∞–Ω–¥—ã –≤ –º–µ–Ω—é Telegram (‚ò∞).

**–ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –º–µ–Ω—é (–≤—Å–µ–≥–¥–∞ –≤–∏–¥–Ω–æ):**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üìä –°—Ç–∞—Ç—É—Å    ‚îÇ üìà –û—Ç—á—ë—Ç     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚îÇ ‚ùì –ü–æ–º–æ—â—å    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ö–æ–º–∞–Ω–¥—ã (–º–µ–Ω—é ‚ò∞):**
| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/start` | –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É, –ø–æ–∫–∞–∑–∞—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é |
| `/status` | –¢–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è CO2/—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã/–≤–ª–∞–∂–Ω–æ—Å—Ç–∏ |
| `/report` | –û—Ç—á—ë—Ç –∑–∞ –ø–µ—Ä–∏–æ–¥ (1—á/6—á/12—á/24—á/7–¥/30–¥) + –Ω–æ—á–Ω–æ–π/–¥–Ω–µ–≤–Ω–æ–π |
| `/history` | –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫–∞–∑–∞–Ω–∏–π (—É—Å—Ä–µ–¥–Ω—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–µ—Ä–∏–æ–¥) |
| `/live` | Live —Ä–µ–∂–∏–º ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫ |
| `/devices` | –°–ø–∏—Å–æ–∫ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ |
| `/bind` | –ü—Ä–∏–≤—è–∑–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–æ –∫–æ–¥—É –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ |
| `/settings` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π |
| `/help` | –°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É |
| `/admin` | –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤) |

**–í—ã–±–æ—Ä –ø–µ—Ä–∏–æ–¥–∞ –æ—Ç—á—ë—Ç–∞:**
–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ üìà –û—Ç—á—ë—Ç –∏–ª–∏ `/report` –ø–æ—è–≤–ª—è–µ—Ç—Å—è –º–µ–Ω—é –≤—ã–±–æ—Ä–∞:
- 1 —á–∞—Å, 6 —á–∞—Å–æ–≤, 12 —á–∞—Å–æ–≤, 24 —á–∞—Å–∞, 7 –¥–Ω–µ–π, 30 –¥–Ω–µ–π
- üåô –ù–æ—á–Ω–æ–π (22:00-08:00) ‚Äî —Å –æ—Ü–µ–Ω–∫–æ–π –∫–∞—á–µ—Å—Ç–≤–∞ —Å–Ω–∞
- ‚òÄÔ∏è –î–Ω–µ–≤–Ω–æ–π (08:00-22:00) ‚Äî –∏—Ç–æ–≥–∏ –¥–Ω—è

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
- –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏–π
- –ü–æ—Ä–æ–≥ CO2 –¥–ª—è –æ–ø–æ–≤–µ—â–µ–Ω–∏–π (400-5000 ppm)
- –í—Ä–µ–º—è —É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –æ—Ç—á—ë—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 08:00)
- –í—Ä–µ–º—è –≤–µ—á–µ—Ä–Ω–µ–≥–æ –æ—Ç—á—ë—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 22:00)

**–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å:**
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö (30/60/120/300 —Å–µ–∫)
- MQTT push –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ

### Live —Ä–µ–∂–∏–º (`/live`)

–†–µ–∂–∏–º —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º:
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 5 –º–∏–Ω, 30 –º–∏–Ω, 1 —á–∞—Å
- **–ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
- **–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:** CO2, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤–ª–∞–∂–Ω–æ—Å—Ç—å, —Å—Ç–∞—Ç—É—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- **–¢–∞–π–º–µ—Ä:** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è
- **–ö–Ω–æ–ø–∫–∞:** ‚èπ –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–ª—è –¥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

### –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫–∞–∑–∞–Ω–∏–π (`/history`)

–°–ø–∏—Å–æ–∫ —É—Å—Ä–µ–¥–Ω—ë–Ω–Ω—ã—Ö –ø–æ–∫–∞–∑–∞–Ω–∏–π –∑–∞ –ø–µ—Ä–∏–æ–¥:
- **–ü–µ—Ä–∏–æ–¥—ã:** 1—á, 6—á, 12—á, 24—á, 7–¥, 30–¥
- **–ó–∞–ø–∏—Å–µ–π:** –¥–æ 12 (< 24—á) –∏–ª–∏ –¥–æ 24 (>= 24—á)
- **–§–æ—Ä–º–∞—Ç:** –≤—Ä–µ–º—è, CO2, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤–ª–∞–∂–Ω–æ—Å—Ç—å
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:** —Å—Ä–µ–¥–Ω–µ–µ, –º–∏–Ω–∏–º—É–º, –º–∞–∫—Å–∏–º—É–º

### –°—Ç–∞—Ç—É—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤

–£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–Ω–ª–∞–π–Ω/–æ—Ñ–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å–∞:
- –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è **offline** –µ—Å–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏–ª–æ 3 –æ—Ç–ø—Ä–∞–≤–∫–∏
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö ("5 –º–∏–Ω –Ω–∞–∑–∞–¥")
- –ü—Ä–∏ –æ—Ñ–ª–∞–π–Ω–µ ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á—ë—Ç—ã

–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç—á—ë—Ç—ã –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
- **–£—Ç—Ä–µ–Ω–Ω–∏–π –æ—Ç—á—ë—Ç** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 08:00) ‚Äî –∞–Ω–∞–ª–∏–∑ –Ω–æ—á–Ω–æ–≥–æ —Å–Ω–∞
- **–í–µ—á–µ—Ä–Ω–∏–π –æ—Ç—á—ë—Ç** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 22:00) ‚Äî –∏—Ç–æ–≥–∏ –¥–Ω—è

### –ò–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (matplotlib + scipy) –≤ —Å—Ç–∏–ª–µ Apple Stocks:
- –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ (#000000) —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–º–∏ –∑–∞–ª–∏–≤–∫–∞–º–∏
- –ú–Ω–æ–≥–æ—Ü–≤–µ—Ç–Ω–∞—è –ª–∏–Ω–∏—è –ø–æ —É—Ä–æ–≤–Ω—é CO2 (–∑–µ–ª—ë–Ω—ã–π ‚Üí –∂—ë–ª—Ç—ã–π ‚Üí –æ—Ä–∞–Ω–∂–µ–≤—ã–π ‚Üí –∫—Ä–∞—Å–Ω—ã–π)
- –°–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ (spline –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è + –∞–≥—Ä–µ–≥–∞—Ü–∏—è)
- –ú–æ–±–∏–ª—å–Ω–æ-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã (96pt –∑–∞–≥–æ–ª–æ–≤–æ–∫, 48pt —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π Y-axis —Å 15% padding
- –ö–∞—Ä—Ç–æ—á–∫–∏ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π (—Å—Ä–µ–¥–Ω–µ–µ, –º–∏–Ω, –º–∞–∫—Å)
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏

**–ó–æ–Ω—ã –∫–∞—á–µ—Å—Ç–≤–∞ –≤–æ–∑–¥—É—Ö–∞:**
- üü¢ < 800 ppm ‚Äî –û—Ç–ª–∏—á–Ω–æ
- üü° 800-1000 ppm ‚Äî –•–æ—Ä–æ—à–æ
- üü† 1000-1500 ppm ‚Äî –ü—Ä–æ–≤–µ—Ç—Ä–∏—Ç–µ
- üî¥ > 1500 ppm ‚Äî –ö—Ä–∏—Ç–∏—á–Ω–æ

**–ü—Ä–∞–≤–∏–ª–∞ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤:**
| –ü–µ—Ä–∏–æ–¥ | –ê–≥—Ä–µ–≥–∞—Ü–∏—è | –¢–æ—á–∫–∏ —Å–ø–ª–∞–π–Ω–∞ |
|--------|-----------|---------------|
| 1 —á–∞—Å | 2 —Ç–æ—á–∫–∏ | 50 |
| 6 —á–∞—Å–æ–≤ | 4 —Ç–æ—á–∫–∏ | 80 |
| 12-24 —á–∞—Å–∞ | 6 —Ç–æ—á–µ–∫ | 100 |
| 7 –¥–Ω–µ–π | 12 —Ç–æ—á–µ–∫ | 120 |
| 30 –¥–Ω–µ–π | 24 —Ç–æ—á–∫–∏ | 150 |

### –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

–ü–æ–¥–¥–µ—Ä–∂–∫–∞ Raspberry Pi —Å –¥–∞—Ç—á–∏–∫–∞–º–∏:
- **MH-Z19** ‚Äî CO2 (UART)
- **DHT22/AM2302** ‚Äî —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ + –≤–ª–∞–∂–Ω–æ—Å—Ç—å
- **BME280** ‚Äî —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ + –≤–ª–∞–∂–Ω–æ—Å—Ç—å + –¥–∞–≤–ª–µ–Ω–∏–µ (I2C)

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:
```bash
curl -sL http://31.59.170.64:10900/install.py | python3
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
v1.2/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/           # FastAPI –¥–ª—è OTA –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ bot/           # Telegram –±–æ—Ç (aiogram 3.x)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.py    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ –º–µ–Ω—é
‚îÇ   ‚îú‚îÄ‚îÄ core/          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ models/        # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ mqtt/          # MQTT –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ services/      # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ       ‚îú‚îÄ‚îÄ charts.py      # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫ (Apple Stocks style)
‚îÇ       ‚îî‚îÄ‚îÄ scheduler.py   # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∞–≤—Ç–æ–æ—Ç—á—ë—Ç–æ–≤
‚îú‚îÄ‚îÄ alembic/           # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îú‚îÄ‚îÄ device/            # –ü—Ä–æ—à–∏–≤–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ INFISICAL.md       # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Å–µ–∫—Ä–µ—Ç–∞–º
‚îî‚îÄ‚îÄ README.md          # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã

| –¢–∞–±–ª–∏—Ü–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `users` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Telegram (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π) |
| `devices` | –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (UID, –∫–æ–¥ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏, –∏–Ω—Ç–µ—Ä–≤–∞–ª) |
| `telemetry` | –ü–æ–∫–∞–∑–∞–Ω–∏—è –¥–∞—Ç—á–∏–∫–æ–≤ (CO2, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤–ª–∞–∂–Ω–æ—Å—Ç—å) |

### –ú–æ–¥–µ–ª—å User

```python
- telegram_id: int (unique, BigInteger)
- timezone: str (default "Europe/Moscow")
- alerts_enabled: bool (default True)
- alert_threshold: int (default 1000 ppm)
- morning_report_enabled: bool (default True)
- morning_report_time: time (default 08:00)
- evening_report_enabled: bool (default True)
- evening_report_time: time (default 22:00)
```

### –ú–æ–¥–µ–ª—å Device

```python
- device_uid: str (unique)
- activation_code: str (8 —Å–∏–º–≤–æ–ª–æ–≤)
- send_interval: int (—Å–µ–∫—É–Ω–¥—ã, default 60)
- owner_telegram_id: int (FK ‚Üí users, BigInteger)
- is_online: bool
- last_seen: datetime
- firmware_version: str
```

### –ú–æ–¥–µ–ª—å Telemetry

```python
- device_id: int (FK ‚Üí devices)
- co2: int (ppm)
- temperature: float (¬∞C)
- humidity: float (%)
- timestamp: datetime
```

## –î–µ–ø–ª–æ–π

### GitHub Actions

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–∏ push –≤ `main`:
1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ SSH
2. `git pull`
3. `./start.sh` (–∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ Infisical)
4. `docker compose up -d --build`
5. –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π

```bash
ssh root@31.59.170.64
cd /opt/apps/co2
./start.sh
docker exec -it co2_mqtt alembic upgrade head
```

## –°–µ–∫—Ä–µ—Ç—ã

–í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ **Infisical Cloud EU**.

–°–º. [INFISICAL.md](INFISICAL.md) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
- `BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
- `POSTGRES_PASSWORD` ‚Äî –ø–∞—Ä–æ–ª—å PostgreSQL
- `MQTT_EXTERNAL_PORT` ‚Äî –≤–Ω–µ—à–Ω–∏–π –ø–æ—Ä—Ç MQTT (10883)
- `ADMIN_USER_IDS` ‚Äî ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```
# Database
sqlalchemy[asyncio]==2.0.23
asyncpg==0.29.0
alembic==1.13.1

# Telegram Bot
aiogram==3.3.0

# MQTT
paho-mqtt==2.0.0

# API Server
fastapi==0.109.0
uvicorn[standard]==0.27.0

# Charts & Infographics
matplotlib==3.8.2
seaborn==0.13.1
scipy==1.11.4
```

## –ë—ç–∫–ª–æ–≥

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
- [ ] –ü–æ—á–∏–Ω–∏—Ç—å –≤—ã–≤–æ–¥ –Ω–∞ –¥–∏—Å–ø–ª–µ–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (—Å–µ–π—á–∞—Å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- [ ] –û–ø–æ–≤–µ—â–µ–Ω–∏—è –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–∞ CO2 (push –≤ Telegram)
- [ ] –ü–æ–ª–∏—Ç–∏–∫–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (—É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π —Å—Ç–∞—Ä—à–µ N –¥–Ω–µ–π)
- [ ] –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è (–ø–æ—á–∞—Å–æ–≤—ã–µ/–¥–Ω–µ–≤–Ω—ã–µ —Å—Ä–µ–¥–Ω–∏–µ)

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
- [ ] –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ CSV/JSON
- [ ] –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤ (–Ω–µ–¥–µ–ª—è –∫ –Ω–µ–¥–µ–ª–µ)

### –ò–¥–µ–∏ –Ω–∞ –±—É–¥—É—â–µ–µ
- [ ] –í–µ–±-—Å–∞–π—Ç —Å –¥–∞—à–±–æ—Ä–¥–æ–º
- [ ] –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (iOS, Android)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Home Assistant (MQTT discovery)
- [ ] –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è CO2 (ML)
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–≥–æ–¥—ã

## –ò—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π

### v1.2.5 (—Ç–µ–∫—É—â–∞—è)
- `/live` ‚Äî —Ä–µ–∂–∏–º —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫
- `/history` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –ø–æ–∫–∞–∑–∞–Ω–∏–π —Å —É—Å—Ä–µ–¥–Ω—ë–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–¥–æ 12/24 –∑–∞–ø–∏—Å–µ–π)
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Å—Ç–∞—Ç—É—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (offline –µ—Å–ª–∏ –ø—Ä–æ–ø—É—â–µ–Ω–æ 3 –æ—Ç–ø—Ä–∞–≤–∫–∏)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö ("5 –º–∏–Ω –Ω–∞–∑–∞–¥")
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –≤ —Å–µ—Ç–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### v1.2.4
- –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –º–µ–Ω—é –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞ (ReplyKeyboardMarkup —Å is_persistent)
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥ –≤ –º–µ–Ω—é Telegram (set_my_commands)
- –û–±—ä–µ–¥–∏–Ω–µ–Ω—ã –∫–æ–º–∞–Ω–¥—ã –∏ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é
- –£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã (/morning, /evening, /menu)
- –ù–æ—á–Ω–æ–π/–î–Ω–µ–≤–Ω–æ–π –æ—Ç—á—ë—Ç –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ inline –∫–Ω–æ–ø–∫–∏ –≤ /report
- –£–ª—É—á—à–µ–Ω–Ω–æ–µ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ (–∞–≥—Ä–µ–≥–∞—Ü–∏—è + spline –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º)

### v1.2.3
- –ú–Ω–æ–≥–æ—Ü–≤–µ—Ç–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ CO2 –≤ —Å—Ç–∏–ª–µ Apple Stocks
- –¶–≤–µ—Ç –ª–∏–Ω–∏–∏ –∏ –∑–∞–ª–∏–≤–∫–∏ –º–µ–Ω—è–µ—Ç—Å—è –ø–æ —É—Ä–æ–≤–Ω—é CO2
- –ú–æ–±–∏–ª—å–Ω–æ-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã

### v1.2.2
- –ö–æ–º–∞–Ω–¥–∞ `/report` ‚Äî –ø–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç –∑–∞ 24 —á–∞—Å–∞ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–æ–π
- –£–¥–∞–ª–µ–Ω–∞ –¥—É–±–ª–∏—Ä—É—é—â–∞—è –∫–æ–º–∞–Ω–¥–∞ `/chart`
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

### v1.2.1
- –ò–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏ (matplotlib + seaborn)
- –ö–æ–º–∞–Ω–¥—ã `/morning`, `/evening`
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π `/settings`
- –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç—á—ë—Ç–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —á–µ—Ä–µ–∑ –±–æ—Ç–∞
- MQTT push –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

### v1.2.0
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —á–∞—Å–æ–≤—ã—Ö –ø–æ—è—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Ç–∏–ø Telegram ID (BigInteger)
- MQTT_EXTERNAL_PORT –∏–∑ Infisical

### v1.1.0
- –ü—Ä–∏–≤—è–∑–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø–æ –∫–æ–¥—É –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
- OTA –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—à–∏–≤–∫–∏

### v1.0.0
- –ë–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –±–æ—Ç–∞
- MQTT —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è
- PostgreSQL —Ö—Ä–∞–Ω–µ–Ω–∏–µ

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
