# CO2 Monitor v2.3.0

–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ CO2 —Å Telegram –±–æ—Ç–æ–º, –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞–º–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –æ—Ç—á—ë—Ç–∞–º–∏.

## Changelog

### v2.3.0 (aea319e) + hotfix (ea83169)
- **CO2 —É—Ä–æ–≤–Ω–∏**: –æ–±–Ω–æ–≤–ª–µ–Ω—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞—É—á–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π (Harvard, ASHRAE, 2023 meta-analysis)
  - üíö <600 ppm ‚Äî –û—Ç–ª–∏—á–Ω–æ (–∫–∞–∫ –Ω–∞ —É–ª–∏—Ü–µ)
  - üü¢ 600-800 ppm ‚Äî –•–æ—Ä–æ—à–æ
  - üü° 800-1000 ppm ‚Äî –ù–æ—Ä–º–∞
  - üü† 1000-1500 ppm ‚Äî –ü–ª–æ—Ö–æ
  - üî¥ >1500 ppm ‚Äî –ö—Ä–∏—Ç–∏—á–Ω–æ
- **Alert threshold**: –∏–∑–º–µ–Ω—ë–Ω default —Å 1000 –Ω–∞ 800 ppm
- **Device firmware v2.3.0**: smart display caching (15s) ‚Äî —É—Å—Ç—Ä–∞–Ω—è–µ—Ç –º–µ—Ä—Ü–∞–Ω–∏–µ –¥–∏—Å–ø–ª–µ—è
- **Hotfix (ea83169)**: –∏—Å–ø—Ä–∞–≤–ª–µ–Ω NameError `time_moderate` –≤ zone_items –æ—Ç—á—ë—Ç–æ–≤

### v2.2.0 (6be36e2)
- –†—É—á–Ω–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ CO2 —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Telegram –±–æ—Ç–∞
- –ö–æ–º–∞–Ω–¥–∞ `calibrate` –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç force_calibration –Ω–∞ 420 ppm

### v2.1.1 (1b35b6f)
- –£–±—Ä–∞–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö ‚Äî —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤—Å–µ–≥–¥–∞ (SCD41 –∏–º–µ–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     MQTT      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Raspberry Pi   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   MQTT Broker    ‚îÇ
‚îÇ  + MH-Z19/DHT22 ‚îÇ               ‚îÇ   (Mosquitto)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                           ‚îÇ
                                           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê               ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Telegram Bot   ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ  MQTT Processor  ‚îÇ
‚îÇ  (aiogram 3.x)  ‚îÇ               ‚îÇ  (saves to DB)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                                 ‚îÇ
         ‚ñº                                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê               ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Scheduler     ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   PostgreSQL     ‚îÇ
‚îÇ (reports/alerts)‚îÇ               ‚îÇ   (telemetry)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

| –°–µ—Ä–≤–∏—Å | –ü–æ—Ä—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|------|----------|
| `co2_mqtt` | - | MQTT –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—é –≤ –ë–î |
| `co2_bot` | - | Telegram –±–æ—Ç + –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –æ—Ç—á—ë—Ç–æ–≤ |
| `co2_api` | 10900 | API –¥–ª—è OTA –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤ |
| `co2_db` | 10532 | PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö |
| `mqtt` | 10883 | MQTT –±—Ä–æ–∫–µ—Ä Mosquitto |

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### Telegram –±–æ—Ç

**–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**
–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –º–µ–Ω—é –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞ (4 –∫–Ω–æ–ø–∫–∏) + –∫–æ–º–∞–Ω–¥—ã –≤ –º–µ–Ω—é Telegram (‚ò∞).

**–ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –º–µ–Ω—é (–≤—Å–µ–≥–¥–∞ –≤–∏–¥–Ω–æ):**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üìä –°—Ç–∞—Ç—É—Å    ‚îÇ üìà –û—Ç—á—ë—Ç     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚îÇ ‚ùì –ü–æ–º–æ—â—å    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ö–æ–º–∞–Ω–¥—ã (–º–µ–Ω—é ‚ò∞):**
| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/start` | –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É, –ø–æ–∫–∞–∑–∞—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é |
| `/status` | –¢–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è CO2/—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã/–≤–ª–∞–∂–Ω–æ—Å—Ç–∏ |
| `/report` | –û—Ç—á—ë—Ç –∑–∞ –ø–µ—Ä–∏–æ–¥ (1—á/6—á/12—á/24—á/7–¥/30–¥) + –Ω–æ—á–Ω–æ–π/–¥–Ω–µ–≤–Ω–æ–π |
| `/history` | –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫–∞–∑–∞–Ω–∏–π (—É—Å—Ä–µ–¥–Ω—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–µ—Ä–∏–æ–¥) |
| `/live` | Live —Ä–µ–∂–∏–º ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫ |
| `/devices` | –°–ø–∏—Å–æ–∫ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ |
| `/bind` | –ü—Ä–∏–≤—è–∑–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–æ –∫–æ–¥—É –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ |
| `/settings` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π |
| `/help` | –°–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É |
| `/admin` | –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤) |

**–í—ã–±–æ—Ä –ø–µ—Ä–∏–æ–¥–∞ –æ—Ç—á—ë—Ç–∞:**
–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ üìà –û—Ç—á—ë—Ç –∏–ª–∏ `/report` –ø–æ—è–≤–ª—è–µ—Ç—Å—è –º–µ–Ω—é –≤—ã–±–æ—Ä–∞:
- 1 —á–∞—Å, 6 —á–∞—Å–æ–≤, 12 —á–∞—Å–æ–≤, 24 —á–∞—Å–∞, 7 –¥–Ω–µ–π, 30 –¥–Ω–µ–π
- üåô –ù–æ—á–Ω–æ–π (22:00-08:00) ‚Äî —Å –æ—Ü–µ–Ω–∫–æ–π –∫–∞—á–µ—Å—Ç–≤–∞ —Å–Ω–∞
- ‚òÄÔ∏è –î–Ω–µ–≤–Ω–æ–π (08:00-22:00) ‚Äî –∏—Ç–æ–≥–∏ –¥–Ω—è

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:**
- –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –æ–ø–æ–≤–µ—â–µ–Ω–∏–π
- –ü–æ—Ä–æ–≥ CO2 –¥–ª—è –æ–ø–æ–≤–µ—â–µ–Ω–∏–π (400-5000 ppm)
- –í—Ä–µ–º—è —É—Ç—Ä–µ–Ω–Ω–µ–≥–æ –æ—Ç—á—ë—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 08:00)
- –í—Ä–µ–º—è –≤–µ—á–µ—Ä–Ω–µ–≥–æ –æ—Ç—á—ë—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 22:00)

**–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å:**
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö (30/60/120/300 —Å–µ–∫)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∏—Å–ø–ª–µ–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–≤–∫–ª/–≤—ã–∫–ª OLED)
- –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –¥–∞—Ç—á–∏–∫–∞ CO2 (force_calibration –Ω–∞ 420 ppm)
- MQTT push –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ

### Live —Ä–µ–∂–∏–º (`/live`)

–†–µ–∂–∏–º —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º:
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 5 –º–∏–Ω, 10 –º–∏–Ω, 15 –º–∏–Ω
- **–ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ (–±–æ—Ç + —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ)
- **–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:** CO2, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤–ª–∞–∂–Ω–æ—Å—Ç—å, —Å—Ç–∞—Ç—É—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- **–¢–∞–π–º–µ—Ä:** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è
- **–ö–Ω–æ–ø–∫–∞:** ‚èπ –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–ª—è –¥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- **MQTT –∫–æ–º–∞–Ω–¥–∞:** –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–ª—É—á–∞–µ—Ç `live_mode` –∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ 5-—Å–µ–∫—É–Ω–¥–Ω—É—é –æ—Ç–ø—Ä–∞–≤–∫—É

### –ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫–∞–∑–∞–Ω–∏–π (`/history`)

–°–ø–∏—Å–æ–∫ —É—Å—Ä–µ–¥–Ω—ë–Ω–Ω—ã—Ö –ø–æ–∫–∞–∑–∞–Ω–∏–π –∑–∞ –ø–µ—Ä–∏–æ–¥:
- **–ü–µ—Ä–∏–æ–¥—ã:** 1—á, 6—á, 12—á, 24—á, 7–¥, 30–¥
- **–ó–∞–ø–∏—Å–µ–π:** –¥–æ 12 (< 24—á) –∏–ª–∏ –¥–æ 24 (>= 24—á)
- **–§–æ—Ä–º–∞—Ç:** –≤—Ä–µ–º—è, CO2, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤–ª–∞–∂–Ω–æ—Å—Ç—å
- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:** —Å—Ä–µ–¥–Ω–µ–µ, –º–∏–Ω–∏–º—É–º, –º–∞–∫—Å–∏–º—É–º

### –°—Ç–∞—Ç—É—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤

–£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–Ω–ª–∞–π–Ω/–æ—Ñ–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å–∞:
- –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è **offline** –µ—Å–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏–ª–æ 3 –æ—Ç–ø—Ä–∞–≤–∫–∏
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö ("5 –º–∏–Ω –Ω–∞–∑–∞–¥")
- –ü—Ä–∏ –æ—Ñ–ª–∞–π–Ω–µ ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á—ë—Ç—ã

–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç—á—ë—Ç—ã –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
- **–£—Ç—Ä–µ–Ω–Ω–∏–π –æ—Ç—á—ë—Ç** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 08:00) ‚Äî –∞–Ω–∞–ª–∏–∑ –Ω–æ—á–Ω–æ–≥–æ —Å–Ω–∞
- **–í–µ—á–µ—Ä–Ω–∏–π –æ—Ç—á—ë—Ç** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 22:00) ‚Äî –∏—Ç–æ–≥–∏ –¥–Ω—è

### –ò–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏

–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (matplotlib + scipy) –≤ —Å—Ç–∏–ª–µ Apple Stocks:
- –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ (#000000) —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–º–∏ –∑–∞–ª–∏–≤–∫–∞–º–∏
- –ú–Ω–æ–≥–æ—Ü–≤–µ—Ç–Ω–∞—è –ª–∏–Ω–∏—è –ø–æ —É—Ä–æ–≤–Ω—é CO2 (–∑–µ–ª—ë–Ω—ã–π ‚Üí –∂—ë–ª—Ç—ã–π ‚Üí –æ—Ä–∞–Ω–∂–µ–≤—ã–π ‚Üí –∫—Ä–∞—Å–Ω—ã–π)
- –°–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ (spline –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è + –∞–≥—Ä–µ–≥–∞—Ü–∏—è)
- –ú–æ–±–∏–ª—å–Ω–æ-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã (96pt –∑–∞–≥–æ–ª–æ–≤–æ–∫, 48pt —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π Y-axis —Å 15% padding
- –ö–∞—Ä—Ç–æ—á–∫–∏ —Å–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π (—Å—Ä–µ–¥–Ω–µ–µ, –º–∏–Ω, –º–∞–∫—Å)
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–µ –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏

**–ó–æ–Ω—ã –∫–∞—á–µ—Å—Ç–≤–∞ –≤–æ–∑–¥—É—Ö–∞ (–Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞—É—á–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π):**
- üíö < 600 ppm ‚Äî –û—Ç–ª–∏—á–Ω–æ (–∫–∞–∫ –Ω–∞ —É–ª–∏—Ü–µ)
- üü¢ 600-800 ppm ‚Äî –•–æ—Ä–æ—à–æ
- üü° 800-1000 ppm ‚Äî –ù–æ—Ä–º–∞
- üü† 1000-1500 ppm ‚Äî –ü–ª–æ—Ö–æ
- üî¥ > 1500 ppm ‚Äî –ö—Ä–∏—Ç–∏—á–Ω–æ

**–ü—Ä–∞–≤–∏–ª–∞ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–æ–≤:**
| –ü–µ—Ä–∏–æ–¥ | –ê–≥—Ä–µ–≥–∞—Ü–∏—è | –¢–æ—á–∫–∏ —Å–ø–ª–∞–π–Ω–∞ |
|--------|-----------|---------------|
| 1 —á–∞—Å | 2 —Ç–æ—á–∫–∏ | 50 |
| 6 —á–∞—Å–æ–≤ | 4 —Ç–æ—á–∫–∏ | 80 |
| 12-24 —á–∞—Å–∞ | 6 —Ç–æ—á–µ–∫ | 100 |
| 7 –¥–Ω–µ–π | 12 —Ç–æ—á–µ–∫ | 120 |
| 30 –¥–Ω–µ–π | 24 —Ç–æ—á–∫–∏ | 150 |

### –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

–ü–æ–¥–¥–µ—Ä–∂–∫–∞ Raspberry Pi —Å –¥–∞—Ç—á–∏–∫–∞–º–∏:
- **SCD41** ‚Äî CO2 + —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ + –≤–ª–∞–∂–Ω–æ—Å—Ç—å (I2C, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- **MH-Z19** ‚Äî CO2 (UART)
- **DHT22/AM2302** ‚Äî —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ + –≤–ª–∞–∂–Ω–æ—Å—Ç—å
- **BME280** ‚Äî —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ + –≤–ª–∞–∂–Ω–æ—Å—Ç—å + –¥–∞–≤–ª–µ–Ω–∏–µ (I2C)

–î–∏—Å–ø–ª–µ–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
- **SSD1306** ‚Äî OLED 128x64 (I2C)

### –î–∞—Ç—á–∏–∫ SCD41 (Sensirion)

**–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- [Datasheet (PDF)](https://sensirion.com/media/documents/48C4B7FB/64C134E7/Sensirion_SCD4x_Datasheet.pdf)
- [Product Page](https://sensirion.com/products/catalog/SCD41)

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –î–∏–∞–ø–∞–∑–æ–Ω CO2 | 400 ‚Äì 5000 ppm |
| –¢–æ—á–Ω–æ—Å—Ç—å CO2 | ¬±(40 ppm + 5%) |
| –î–∏–∞–ø–∞–∑–æ–Ω —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã | -10 ‚Äì 60¬∞C |
| –î–∏–∞–ø–∞–∑–æ–Ω –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ | 0 ‚Äì 100% RH |
| –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å | I2C (–∞–¥—Ä–µ—Å 0x62) |
| –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ | 2.4 ‚Äì 5.5V |

**–†–µ–∂–∏–º—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è:**
| –†–µ–∂–∏–º | –ò–Ω—Ç–µ—Ä–≤–∞–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------|
| **Periodic** | 5 —Å–µ–∫ | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä–µ–∂–∏–º, –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫ |
| **Low Power** | ~30 —Å–µ–∫ | –≠–∫–æ–Ω–æ–º–∏—è —ç–Ω–µ—Ä–≥–∏–∏ –¥–ª—è –±–∞—Ç–∞—Ä–µ–π–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ |
| **Single Shot** | –ü–æ –∑–∞–ø—Ä–æ—Å—É | –†–∞–∑–æ–≤–æ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è 5-–º–∏–Ω—É—Ç–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ |

**–í–∞–∂–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚ö†Ô∏è **–ü–µ—Ä–≤—ã–µ 2 —á—Ç–µ–Ω–∏—è –ø–æ—Å–ª–µ –≤–∫–ª—é—á–µ–Ω–∏—è ‚Äî –º—É—Å–æ—Ä** (–¥–∞—Ç—á–∏–∫ "–ø—Ä–æ–≥—Ä–µ–≤–∞–µ—Ç—Å—è")
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –æ–ø—Ä–æ—Å–∞ ‚Äî **5 —Å–µ–∫—É–Ω–¥** (—á–∞—â–µ —á–∏—Ç–∞—Ç—å –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω–æ)
- **–ê–≤—Ç–æ–∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ (ASC)** –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è 5-–º–∏–Ω—É—Ç–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤
- –°–∫–∞—á–∫–∏ CO2 > 500 ppm –∑–∞ –æ–¥–Ω–æ —á—Ç–µ–Ω–∏–µ ‚Äî —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –æ—à–∏–±–∫–∞ –¥–∞—Ç—á–∏–∫–∞

**–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏:**
- Python (CircuitPython): `adafruit-circuitpython-scd4x`
- Arduino: [SparkFun SCD4x Library](https://github.com/sparkfun/SparkFun_SCD4x_Arduino_Library)
- Raspberry Pi: [Sensirion Driver](https://github.com/Sensirion/raspberry-pi-i2c-scd4x)

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**
```bash
# –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å 0x62 (SCD41) –∏ 0x3c (SSD1306 –¥–∏—Å–ø–ª–µ–π)
i2cdetect -y 1
```

### –î–∏—Å–ø–ª–µ–π SSD1306

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ: 128√ó64 –ø–∏–∫—Å–µ–ª–µ–π
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å: I2C (–∞–¥—Ä–µ—Å 0x3C)
- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞: `adafruit-circuitpython-ssd1306`

**–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ CO2:**
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞: scale=7 –¥–ª—è 3 —Ü–∏—Ñ—Ä (400-999), scale=5 –¥–ª—è 4 —Ü–∏—Ñ—Ä (1000+)
- –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ –∏ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:
```bash
curl -sL http://31.59.170.64:10900/install.py | python3
sudo bash ~/co2-monitor/install_service.sh
```

### OTA-—Å–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç **bootstrap loader** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     HTTP      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  bootstrap.py   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   API Server     ‚îÇ
‚îÇ  (immutable)    ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ  /api/device/*   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   main.py       ‚îÇ  ‚Üê –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è OTA
‚îÇ  (updatable)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
1. Bootstrap –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `/api/device/manifest` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
2. –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç hash/date/version —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–µ–π
3. –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:
   - –°–æ–∑–¥–∞—ë—Ç backup —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏
   - –°–∫–∞—á–∏–≤–∞–µ—Ç –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç hash —Ñ–∞–π–ª–∞
   - –ó–∞–ø—É—Å–∫–∞–µ—Ç health check (5 –ø–æ–ø—ã—Ç–æ–∫ —á—Ç–µ–Ω–∏—è —Å–µ–Ω—Å–æ—Ä–∞, ~25 —Å–µ–∫)
   - –ü—Ä–∏ –æ—à–∏–±–∫–µ ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π rollback

**‚ö†Ô∏è –í–∞–∂–Ω–æ –ø—Ä–æ Health Check:**
- SCD41 –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –ø–µ—Ä–≤—ã–µ 2 —á—Ç–µ–Ω–∏—è –∫–∞–∫ "–º—É—Å–æ—Ä"
- Health check –¥–µ–ª–∞–µ—Ç 5 –ø–æ–ø—ã—Ç–æ–∫ (–Ω–µ 2!) —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ï—Å–ª–∏ –º–µ–Ω—å—à–µ –ø–æ–ø—ã—Ç–æ–∫ ‚Äî OTA –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –æ—Ç–∫–∞—Ç—ã–≤–∞—Ç—å—Å—è

**–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:**
- –ß–µ—Ä–µ–∑ Telegram –±–æ—Ç: –ê–¥–º–∏–Ω ‚Üí ‚öôÔ∏è Force Update
- –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É —á–µ—Ä–µ–∑ MQTT
- main.py –≤—ã—Ö–æ–¥–∏—Ç —Å –∫–æ–¥–æ–º 100
- Bootstrap –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**Endpoints API:**
| Endpoint | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `/install.py` | –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –¥–ª—è –Ω–æ–≤–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ |
| `/api/device/bootstrap` | Bootstrap loader (–Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è) |
| `/api/device/manifest` | –í–µ—Ä—Å–∏—è/hash —Ç–µ–∫—É—â–µ–π –ø—Ä–æ—à–∏–≤–∫–∏ |
| `/api/device/script` | main.py (–æ–±–Ω–æ–≤–ª—è–µ–º—ã–π –∫–æ–¥) |
| `/api/device/config` | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è MQTT |

### SSH Tunnel (—É–¥–∞–ª—ë–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ RPi)

Reverse SSH —Ç—É–Ω–Ω–µ–ª—å –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ Raspberry Pi 5 –∏–∑ –ª—é–±–æ–≥–æ –º–µ—Å—Ç–∞.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
[MacBook] --> [Server:2222] <-- [RPi tunnel] <-- [RPi SSH:22]
     ^                              ^
     |                              |
  id_rpi key                   tunnel_key
```

**–ë—ã—Å—Ç—Ä–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:**
```bash
# –ß–µ—Ä–µ–∑ alias (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω ~/.ssh/config)
ssh co2-rpi

# –ù–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ —Ç—É–Ω–Ω–µ–ª—å
ssh -i ~/.ssh/id_rpi -p 2222 mazukabz@31.59.170.64

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ CO2 —Å–µ—Ä–≤–∏—Å–∞
ssh co2-rpi "journalctl -u co2-monitor -n 50 --no-pager"

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
ssh co2-rpi "journalctl -u co2-monitor -f"
```

**–¢–µ–∫—É—â–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ | Raspberry Pi 5 (piserver) |
| –°–µ—Ä–≤–µ—Ä | 31.59.170.64 |
| –ü–æ—Ä—Ç —Ç—É–Ω–Ω–µ–ª—è | 2222 |
| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ RPi | mazukabz |
| –ö–ª—é—á | ~/.ssh/id_rpi |

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ MacBook (~/.ssh/config):**
```
Host co2-rpi
  HostName 31.59.170.64
  Port 2222
  User mazukabz
  IdentityFile ~/.ssh/id_rpi
```

**–ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –Ω–∞ RPi:**
```bash
# –°—Ç–∞—Ç—É—Å CO2 —Å–µ—Ä–≤–∏—Å–∞
sudo systemctl status co2-monitor

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
sudo systemctl restart co2-monitor

# –°—Ç–∞—Ç—É—Å SSH —Ç—É–Ω–Ω–µ–ª—è
sudo systemctl status ssh-tunnel

# –ü—Ä–æ–≤–µ—Ä–∫–∞ I2C —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (SCD41=0x62, SSD1306=0x3c)
i2cdetect -y 1
```

**–ü–æ—Ä—Ç—ã —Ç—É–Ω–Ω–µ–ª–µ–π:**
| –ü–æ—Ä—Ç | –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ |
|------|------------|
| 2222 | CO2 Monitor RPi 5 |
| 2223-2230 | –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ |

**–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** [ssh-tunnels/README.md](ssh-tunnels/README.md)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
v1.2/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ api/           # FastAPI –¥–ª—è OTA –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.py    # Endpoints: /install.py, /api/device/*
‚îÇ   ‚îú‚îÄ‚îÄ bot/           # Telegram –±–æ—Ç (aiogram 3.x)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.py    # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ –º–µ–Ω—é
‚îÇ   ‚îú‚îÄ‚îÄ core/          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ models/        # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ mqtt/          # MQTT –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä + –∫–æ–º–∞–Ω–¥—ã —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ main.py    # publish_device_command() –¥–ª—è force_update
‚îÇ   ‚îî‚îÄ‚îÄ services/      # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ       ‚îú‚îÄ‚îÄ charts.py      # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫ (Apple Stocks style)
‚îÇ       ‚îî‚îÄ‚îÄ scheduler.py   # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∞–≤—Ç–æ–æ—Ç—á—ë—Ç–æ–≤
‚îú‚îÄ‚îÄ alembic/           # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îú‚îÄ‚îÄ device/            # –ü—Ä–æ—à–∏–≤–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
‚îÇ   ‚îú‚îÄ‚îÄ bootstrap.py       # OTA loader (IMMUTABLE)
‚îÇ   ‚îú‚îÄ‚îÄ co2_sensor.py      # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ (main.py –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ)
‚îÇ   ‚îú‚îÄ‚îÄ install_service.sh # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ systemd —Å–µ—Ä–≤–∏—Å–∞
‚îÇ   ‚îî‚îÄ‚îÄ README.md          # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ INFISICAL.md       # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Å–µ–∫—Ä–µ—Ç–∞–º
‚îî‚îÄ‚îÄ README.md          # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü—ã

| –¢–∞–±–ª–∏—Ü–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `users` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Telegram (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π) |
| `devices` | –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (UID, –∫–æ–¥ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏, –∏–Ω—Ç–µ—Ä–≤–∞–ª) |
| `telemetry` | –ü–æ–∫–∞–∑–∞–Ω–∏—è –¥–∞—Ç—á–∏–∫–æ–≤ (CO2, —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤–ª–∞–∂–Ω–æ—Å—Ç—å) |

### –ú–æ–¥–µ–ª—å User

```python
- telegram_id: int (unique, BigInteger)
- timezone: str (default "Europe/Moscow")
- alerts_enabled: bool (default True)
- alert_threshold: int (default 800 ppm)
- morning_report_enabled: bool (default True)
- morning_report_time: time (default 08:00)
- evening_report_enabled: bool (default True)
- evening_report_time: time (default 22:00)
```

### –ú–æ–¥–µ–ª—å Device

```python
- device_uid: str (unique)
- activation_code: str (8 —Å–∏–º–≤–æ–ª–æ–≤)
- send_interval: int (—Å–µ–∫—É–Ω–¥—ã, default 60)
- display_enabled: bool (OLED –¥–∏—Å–ø–ª–µ–π –≤–∫–ª/–≤—ã–∫–ª, default True)
- live_mode_until: datetime (–∫–æ–≥–¥–∞ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è live —Ä–µ–∂–∏–º, nullable)
- owner_telegram_id: int (FK ‚Üí users, BigInteger)
- is_online: bool
- last_seen: datetime
- firmware_version: str
- os_version: str
```

### –ú–æ–¥–µ–ª—å Telemetry

```python
- device_id: int (FK ‚Üí devices)
- co2: int (ppm)
- temperature: float (¬∞C)
- humidity: float (%)
- timestamp: datetime
```

## –î–µ–ø–ª–æ–π

### GitHub Actions

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–∏ push –≤ `main`:
1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ SSH
2. `git pull`
3. `./start.sh` (–∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–µ–∫—Ä–µ—Ç—ã –∏–∑ Infisical)
4. `docker compose up -d --build`
5. –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π

```bash
ssh root@31.59.170.64
cd /opt/apps/co2
./start.sh
docker exec -it co2_mqtt alembic upgrade head
```

## –°–µ–∫—Ä–µ—Ç—ã

–í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ **Infisical Cloud EU**.

–°–º. [INFISICAL.md](INFISICAL.md) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
- `BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω Telegram –±–æ—Ç–∞
- `POSTGRES_PASSWORD` ‚Äî –ø–∞—Ä–æ–ª—å PostgreSQL
- `MQTT_EXTERNAL_PORT` ‚Äî –≤–Ω–µ—à–Ω–∏–π –ø–æ—Ä—Ç MQTT (10883)
- `ADMIN_USER_IDS` ‚Äî ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```
# Database
sqlalchemy[asyncio]==2.0.23
asyncpg==0.29.0
alembic==1.13.1

# Telegram Bot
aiogram==3.3.0

# MQTT
paho-mqtt==2.0.0

# API Server
fastapi==0.109.0
uvicorn[standard]==0.27.0

# Charts & Infographics
matplotlib==3.8.2
seaborn==0.13.1
scipy==1.11.4
```

## –£—Ä–æ–∫–∏ –∏–∑ —Ä–µ–ª–∏–∑–∞ v2.0.0

### –ü—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –≤—Å—Ç—Ä–µ—Ç–∏–ª–∏

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ | –ö–∞–∫ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å |
|---|----------|---------|---------|-------------------|
| 1 | –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å–∫–∞—á–∏–≤–∞–µ—Ç —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é | `git push` –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ | –†—É—á–Ω–æ–π deploy | CI/CD –Ω–∞ —Å–µ—Ä–≤–µ—Ä |
| 2 | –°–µ—Ä–≤–∏—Å –∑–∞–ø—É—Å–∫–∞–µ—Ç main.py –≤–º–µ—Å—Ç–æ bootstrap.py | –°—Ç–∞—Ä—ã–π install_service.sh –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ | –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ | –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ install_service.sh |
| 3 | Bootstrap –Ω–µ —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è | install.py –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–¥ –¥–ª—è bootstrap | git push + rebuild | CI/CD |
| 4 | Health check –ø–∞–¥–∞–µ—Ç | –ù–µ—Ç backup –ø—Ä–∏ –ø–µ—Ä–≤–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ | –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É | –ü—Ä–æ–≤–µ—Ä–∫–∞ "–ø–µ—Ä–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞" |
| 5 | –ù–µ—è—Å–Ω–æ –∫–∞–∫–∞—è –≤–µ—Ä—Å–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç | –ù–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–µ—Ä—Å–∏–∏ | journalctl | –í–µ—Ä—Å–∏—è –≤ /status –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è |

### –í—ã–≤–æ–¥—ã

1. **–°–µ—Ä–≤–µ—Ä –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ ‚Äî —Ä–∞–∑–Ω—ã–µ –¥–æ–º–µ–Ω—ã.** –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ git –ù–ï —Ä–∞–≤–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤.
2. **–ù—É–∂–µ–Ω CI/CD.** –ë–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–æ–ª—É—á–∞—é—Ç —Å—Ç–∞—Ä—ã–π –∫–æ–¥.
3. **–ù—É–∂–Ω—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.** –ë–µ–∑ –Ω–∏—Ö –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ –æ–±–Ω–æ–≤–∏–ª–æ—Å—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏–ª–∏ –Ω–µ—Ç.
4. **–ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ ‚Äî –∫—Ä–∞–π–Ω—è—è –º–µ—Ä–∞.** –ù–æ –∏–Ω–æ–≥–¥–∞ —ç—Ç–æ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–±.
5. **Immutable bootstrap —Ä–∞–±–æ—Ç–∞–µ—Ç.** –û–¥–∏–Ω —Ä–∞–∑ —É—Å—Ç–∞–Ω–æ–≤–∏–ª ‚Äî –≤—Å–µ–≥–¥–∞ –º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å OTA.

### –ß–µ–∫–ª–∏—Å—Ç –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ä–µ–ª–∏–∑–∞

```
[ ] 1. –û–±–Ω–æ–≤–∏—Ç—å FIRMWARE_VERSION –∏ FIRMWARE_DATE –≤ app/api/main.py
[ ] 2. git push origin main
[ ] 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ CI/CD –∑–∞–ø—É—Å—Ç–∏–ª—Å—è (–∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
[ ] 4. –ò–õ–ò —Ä—É—á–Ω–æ–π deploy: ssh server && cd /opt/apps/co2 && git pull && docker compose up -d --build
[ ] 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å /api/device/manifest ‚Äî –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è?
[ ] 6. –û—Ç–ø—Ä–∞–≤–∏—Ç—å Force Update —á–µ—Ä–µ–∑ –±–æ—Ç–∞ (–∏–ª–∏ –∂–¥–∞—Ç—å –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞)
[ ] 7. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ (–∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)
```

## Troubleshooting

### OTA –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ–≥–¥–∞ –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è (Rollback)

**–°–∏–º–ø—Ç–æ–º:** –í –ª–æ–≥–∞—Ö `bootstrap.log` –ø–æ—Å—Ç–æ—è–Ω–Ω–æ "Rollback successful"

**–ü—Ä–∏—á–∏–Ω–∞:** Health check –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å–µ–Ω—Å–æ—Ä
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
ssh co2-rpi "tail -50 ~/co2-monitor/bootstrap.log"
# –ò—â–µ–º: "Health check FAILED: Cannot read sensor"
```

**–†–µ—à–µ–Ω–∏–µ:** Health check –¥–æ–ª–∂–µ–Ω –¥–µ–ª–∞—Ç—å 5+ –ø–æ–ø—ã—Ç–æ–∫ —á—Ç–µ–Ω–∏—è (SCD41 –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –ø–µ—Ä–≤—ã–µ 2):
```python
# –í co2_sensor.py, —Ñ—É–Ω–∫—Ü–∏—è health_check()
for attempt in range(5):  # –ù–ï 2!
    time.sleep(5)
    reading = sensor.read()
```

### –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
ssh co2-rpi "cat ~/co2-monitor/version.json"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
curl -s http://31.59.170.64:10900/api/device/manifest | jq .version

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram –∏–ª–∏:
ssh co2-rpi "rm ~/co2-monitor/version.json && sudo systemctl restart co2-monitor"
```

### SSH: Permission denied (publickey)

**–ü—Ä–∏—á–∏–Ω—ã:**
1. –ö–ª—é—á —Å –ø–∞—Ä–æ–ª–µ–º
2. –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω –Ω–∞ RPi
3. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ authorized_keys

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∫–æ–π –∫–ª—é—á –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
ssh -v co2-rpi 2>&1 | grep "Offering public key"

# 2. –°–æ–∑–¥–∞—Ç—å –∫–ª—é—á –ë–ï–ó –ø–∞—Ä–æ–ª—è
ssh-keygen -t ed25519 -f ~/.ssh/id_rpi -N ""

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ RPi
ssh co2-rpi "chmod 700 ~/.ssh && chmod 600 ~/.ssh/authorized_keys"

# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å fingerprint —Å–æ–≤–ø–∞–¥–∞–µ—Ç
ssh-keygen -lf ~/.ssh/id_rpi.pub  # –Ω–∞ MacBook
ssh co2-rpi "ssh-keygen -lf ~/.ssh/authorized_keys"  # –Ω–∞ RPi
```

### –¢—É–Ω–Ω–µ–ª—å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (Connection refused)

```bash
# –ù–∞ RPi ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
sudo systemctl status ssh-tunnel
journalctl -u ssh-tunnel -n 20

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Ä—Ç
ssh root@31.59.170.64 "ss -tlnp | grep 2222"

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç—É–Ω–Ω–µ–ª—å
ssh co2-rpi "sudo systemctl restart ssh-tunnel"
```

### –î–∏—Å–ø–ª–µ–π –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (font5x8.bin not found)

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞
ssh co2-rpi "ls -la ~/co2-monitor/font5x8.bin"

# –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å (bootstrap —Å–∫–∞—á–∞–µ—Ç)
ssh co2-rpi "sudo systemctl restart co2-monitor"

# –ò–ª–∏ —Å–∫–∞—á–∞—Ç—å –≤—Ä—É—á–Ω—É—é
ssh co2-rpi "cd ~/co2-monitor && curl -sLO https://github.com/adafruit/Adafruit_CircuitPython_framebuf/raw/main/examples/font5x8.bin"
```

### –°–µ–Ω—Å–æ—Ä "Data not ready"

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å I2C —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
ssh co2-rpi "i2cdetect -y 1"
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: 0x3c (display), 0x62 (SCD41)

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å
ssh co2-rpi "sudo systemctl restart co2-monitor"
```

### MQTT –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥
ssh co2-rpi "cat ~/co2-monitor/config.json"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞
ssh co2-rpi "nc -zv 31.59.170.64 10883"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
ssh co2-rpi "journalctl -u co2-monitor -n 30 | grep -i mqtt"
```

### –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–∫—Ä–∞–π–Ω—è—è –º–µ—Ä–∞)

```bash
ssh co2-rpi "
sudo systemctl stop co2-monitor
rm -rf ~/co2-monitor
curl -sL http://31.59.170.64:10900/install.py | python3
sudo bash ~/co2-monitor/install_service.sh
"
```

## –ë—ç–∫–ª–æ–≥

### üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–µ–ø–ª–æ—è)

–£—Ä–æ–∫–∏ –∏–∑ —Ä–µ–ª–∏–∑–∞ v2.0.0 ‚Äî —á—Ç–æ –Ω—É–∂–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å:

- [ ] **CI/CD –Ω–∞ —Å–µ—Ä–≤–µ—Ä** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π `docker compose up -d --build` –ø—Ä–∏ push –≤ main
  - –°–µ–π—á–∞—Å: push –≤ git –ù–ï –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–æ–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
  - –ù—É–∂–Ω–æ: GitHub Actions –∑–∞–ø—É—Å–∫–∞–µ—Ç deploy –ø–æ—Å–ª–µ push
  - –ë–µ–∑ —ç—Ç–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å–∫–∞—á–∏–≤–∞—é—Ç —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é

- [ ] **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞**
  - –ü–æ—Å–ª–µ OTA –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ Telegram: "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ X –æ–±–Ω–æ–≤–ª–µ–Ω–æ –¥–æ v2.0.1"
  - –ü—Ä–∏ rollback: "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ X: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å, –æ—Ç–∫–∞—Ç –Ω–∞ v2.0.0"
  - –ü–æ–º–æ–≥–∞–µ—Ç –ø–æ–Ω—è—Ç—å —á—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—à–ª–æ –±–µ–∑ —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

- [ ] **–í–µ—Ä—Å–∏—è –ø—Ä–æ—à–∏–≤–∫–∏ –≤ `/status`**
  - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é –ø—Ä–æ—à–∏–≤–∫–∏ –≤ —Å—Ç–∞—Ç—É—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
  - "CO2: 650 ppm | Temp: 22¬∞C | Firmware: v2.0.0"

- [ ] **Health check –ø—Ä–∏ –ø–µ—Ä–≤–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ**
  - –°–µ–π—á–∞—Å: "No backup available for rollback" –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
  - –ù—É–∂–Ω–æ: –ü—Ä–æ–ø—É—Å–∫–∞—Ç—å rollback –µ—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞
  - –ò–ª–∏: –°–æ–∑–¥–∞–≤–∞—Ç—å "–ø—É—Å—Ç–æ–π" backup –∫–∞–∫ –º–∞—Ä–∫–µ—Ä

### üü° –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

- [x] ~~–ü–æ—á–∏–Ω–∏—Ç—å –≤—ã–≤–æ–¥ –Ω–∞ –¥–∏—Å–ø–ª–µ–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞~~ ‚úÖ v2.0.1
- [x] ~~–í–µ—Ä—Å–∏—è –û–° –≤ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏~~ ‚úÖ v2.0.2
- [ ] **–£–¥–∞–ª—ë–Ω–Ω—ã–µ –ª–æ–≥–∏ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞** (–¥–∏–∑–∞–π–Ω –Ω–∏–∂–µ)
- [ ] –û–ø–æ–≤–µ—â–µ–Ω–∏—è –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–∞ CO2 (push –≤ Telegram)
- [ ] –ü–æ–ª–∏—Ç–∏–∫–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (—É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π —Å—Ç–∞—Ä—à–µ N –¥–Ω–µ–π)
- [ ] –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è (–ø–æ—á–∞—Å–æ–≤—ã–µ/–¥–Ω–µ–≤–Ω—ã–µ —Å—Ä–µ–¥–Ω–∏–µ)
- [ ] –û—Ñ–ª–∞–π–Ω-–±—É—Ñ–µ—Ä –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:
  - –ü—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–≤—è–∑–∏ —Å MQTT ‚Äî —Å–∫–ª–∞–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ª–æ–∫–∞–ª—å–Ω–æ
  - –ü—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–≤—è–∑–∏ ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º–∏ timestamp
  - –°–µ—Ä–≤–µ—Ä –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (–Ω–µ –∫–∞–∫ "–Ω–æ–≤—ã–µ")
  - –†–∞–∑–º–µ—Ä –±—É—Ñ–µ—Ä–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∏–ø–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (ESP32 / Raspberry Pi)
  - –ö–æ–Ω—Ñ–∏–≥ —Ä–∞–∑–º–µ—Ä–∞ –±—É—Ñ–µ—Ä–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ Infisical, —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∑–∞–±–∏—Ä–∞—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### üü¢ –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

- [ ] –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ CSV/JSON
- [ ] –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–æ–≤ (–Ω–µ–¥–µ–ª—è –∫ –Ω–µ–¥–µ–ª–µ)
- [ ] –¢–µ—Å—Ç—ã API endpoints –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º
- [ ] Smoke test –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è (–ø—Ä–æ–≤–µ—Ä–∫–∞ /health –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö)

### üìã –î–∏–∑–∞–π–Ω: –£–¥–∞–ª—ë–Ω–Ω—ã–µ –ª–æ–≥–∏ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

**–¶–µ–ª—å:** –ü–æ–ª—É—á–∞—Ç—å –æ—à–∏–±–∫–∏ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –±–µ–∑ SSH –¥–æ—Å—Ç—É–ø–∞.

**MQTT —Ç–æ–ø–∏–∫–∏:**
```
devices/{uid}/errors    ‚Äî —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ ‚Üí —Å–µ—Ä–≤–µ—Ä (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö)
devices/{uid}/commands  ‚Äî —Å–µ—Ä–≤–µ—Ä ‚Üí —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ ({"command": "get_logs", "lines": 50})
devices/{uid}/logs      ‚Äî —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ ‚Üí —Å–µ—Ä–≤–µ—Ä (–æ—Ç–≤–µ—Ç –Ω–∞ get_logs)
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ:**
```json
{
  "level": "ERROR",
  "source": "display|sensor|mqtt|update",
  "message": "font5x8.bin not found",
  "timestamp": "2025-12-10T12:34:56Z",
  "firmware_version": "2.0.2"
}
```

**–¢–∏–ø—ã –ª–æ–≥–æ–≤ (—Ç–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏ –∏ –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è):**
| Level | Source | –ö–æ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è |
|-------|--------|-------------------|
| ERROR | sensor | –î–∞—Ç—á–∏–∫ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª—Å—è |
| ERROR | display | –û—à–∏–±–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è |
| ERROR | mqtt | –ü–æ—Ç–µ—Ä—è —Å–≤—è–∑–∏ —Å –±—Ä–æ–∫–µ—Ä–æ–º |
| ERROR | update | OTA update failed + rollback |
| INFO | update | OTA update —É—Å–ø–µ—à–µ–Ω (v2.0.1 ‚Üí v2.0.2) |
| INFO | startup | –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∑–∞–ø—É—Å—Ç–∏–ª–æ—Å—å (–≤–µ—Ä—Å–∏—è, –û–°) |

**–•—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:**
- –ö–æ–ª—å—Ü–µ–≤–æ–π –±—É—Ñ–µ—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 100 –æ—à–∏–±–æ–∫ –≤ `~/co2-monitor/errors.log`
- –ü—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–≤—è–∑–∏ ‚Äî –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏
- –ö–æ–º–∞–Ω–¥–∞ `get_logs` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å—Ç—Ä–æ–∫ –∏–∑ journalctl

**–°–µ—Ä–≤–µ—Ä:**
- –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `device_logs` (device_id, level, source, message, timestamp)
- –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ `devices/+/errors` –∏ `devices/+/logs`
- –ë–æ—Ç: –∫–Ω–æ–ø–∫–∞ "üìú –õ–æ–≥–∏" –≤ –∫–∞—Ä—Ç–æ—á–∫–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- –•—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π –ª–æ–≥–æ–≤

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è (–ø–æ—Ä—è–¥–æ–∫):**
1. –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: ErrorLogger –∫–ª–∞—Å—Å —Å –±—É—Ñ–µ—Ä–æ–º –∏ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ MQTT
2. –°–µ—Ä–≤–µ—Ä: –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ errors/logs —Ç–æ–ø–∏–∫–∏ + —Ç–∞–±–ª–∏—Ü–∞ device_logs
3. –ë–æ—Ç: –∫–Ω–æ–ø–∫–∞ "–õ–æ–≥–∏" + –∫–æ–º–∞–Ω–¥–∞ get_logs

### üîµ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ (—Å–ª–µ–¥—É—é—â–∏–π —Ä–µ–ª–∏–∑)

- [ ] **–ü–æ–∫—Ä—ã—Ç–∏–µ –∞–≤—Ç–æ—Ç–µ—Å—Ç–∞–º–∏ 90%+ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞**
  - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—É—Ç–∏ (MQTT, —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è, –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞)
  - Unit —Ç–µ—Å—Ç—ã: –º–æ–¥–µ–ª–∏, MQTT –∫–æ–º–∞–Ω–¥—ã, API endpoints
  - Integration —Ç–µ—Å—Ç—ã: –±–æ—Ç handlers, MQTT processor
  - E2E —Ç–µ—Å—Ç—ã: –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ ‚Üí —Å–µ—Ä–≤–µ—Ä ‚Üí –±–æ—Ç
  - –¶–µ–ª—å: 90% coverage –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º —Ä–µ–ª–∏–∑–æ–º

- [ ] **–í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –¥–∏—Å–ø–ª–µ–µ**
  - –ü–æ–∫–∞ —Ç–æ–ª—å–∫–æ –≤—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ —á–µ—Ä–µ–∑ –±–æ—Ç, —Å–∞–º–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–¥–Ω–æ (CO2)
  - –ó–∞–≥–ª—É—à–∫–∏ –≤ Telegram –±–æ—Ç–µ –¥–ª—è –±—É–¥—É—â–∏—Ö —Ä–µ–∂–∏–º–æ–≤
  - –í–∞—Ä–∏–∞–Ω—Ç—ã: —Ç–æ–ª—å–∫–æ CO2, CO2 + —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞, –≤—Å–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏

- [ ] **–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∞—Ç—á–∏–∫–∞—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞**
  - –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –≤—Å–µ—Ö –¥–∞—Ç—á–∏–∫–æ–≤
  - –ï—Å–ª–∏ –¥–∏—Å–ø–ª–µ–π –æ—Ç–∫–ª—é—á—ë–Ω –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å "OFF"
  - –ï—Å–ª–∏ –¥–∏—Å–ø–ª–µ–π —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å "NOT CONNECTED"
  - –†–∞—Å—à–∏—Ä—è–µ–º–æ –¥–ª—è –Ω–æ–≤—ã—Ö –¥–∞—Ç—á–∏–∫–æ–≤ –≤ –±—É–¥—É—â–µ–º (BME280, MH-Z19 –∏ –¥—Ä.)
  - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤ –±–æ—Ç–µ: "üñ• Display: ON", "üå° SCD41: OK", "üì∫ OLED: NOT DETECTED"

- [ ] **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ SCD41** (–∏–∑ [datasheet](https://cdn.sparkfun.com/assets/d/4/9/a/d/Sensirion_CO2_Sensors_SCD4x_Datasheet.pdf))
  - **Temperature offset** ‚Äî –∫–æ—Ä—Ä–µ–∫—Ü–∏—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ (default 4¬∞C)
  - **Altitude compensation** ‚Äî –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –≤—ã—Å–æ—Ç—ã –Ω–∞–¥ —É—Ä–æ–≤–Ω–µ–º –º–æ—Ä—è (–º–µ—Ç—Ä—ã)
  - **Ambient pressure compensation** ‚Äî –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –ø–æ –¥–∞–≤–ª–µ–Ω–∏—é (mBar)
  - **Low power mode** ‚Äî –∏–∑–º–µ—Ä–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫ –≤–º–µ—Å—Ç–æ 5 —Å–µ–∫ (—ç–∫–æ–Ω–æ–º–∏—è –±–∞—Ç–∞—Ä–µ–∏)
  - **Single shot mode** ‚Äî –æ–¥–∏–Ω–æ—á–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è –ø–æ –∑–∞–ø—Ä–æ—Å—É (SCD41 only)
  - **Persist settings to EEPROM** ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
  - –°–º. [ESPHome SCD4x](https://esphome.io/components/sensor/scd4x/), [Sensirion SCD41](https://sensirion.com/products/catalog/SCD41)

### üí° –ò–¥–µ–∏ –Ω–∞ –±—É–¥—É—â–µ–µ

- [ ] –í–µ–±-—Å–∞–π—Ç —Å –¥–∞—à–±–æ—Ä–¥–æ–º
- [ ] –ú–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (iOS, Android)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Home Assistant (MQTT discovery)
- [ ] –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è CO2 (ML)
- [ ] –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–æ–≤–µ—Ç—Ä–∏–≤–∞–Ω–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–≥–æ–¥—ã
- [ ] A/B rollout ‚Äî –æ–±–Ω–æ–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Å–Ω–∞—á–∞–ª–∞

## –ò—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π

### v2.2.0 (—Ç–µ–∫—É—â–∞—è) ‚Äî 2025-12-11
**Manual CO2 Calibration**

–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:
- ‚úÖ –ö–æ–º–∞–Ω–¥–∞ `calibrate` ‚Äî —Ä—É—á–Ω–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –¥–∞—Ç—á–∏–∫–∞ SCD41
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–µ—Ç–æ–¥ `force_calibration()` –æ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è
- ‚úÖ –ö–∞–ª–∏–±—Ä—É–µ—Ç –Ω–∞ 420 ppm (—Ç–µ–∫—É—â–∏–π –∞—Ç–º–æ—Å—Ñ–µ—Ä–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å CO2)
- ‚úÖ –ù–∞ –¥–∏—Å–ø–ª–µ–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏

–ë–æ—Ç:
- ‚úÖ –ö–Ω–æ–ø–∫–∞ "üéØ –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ CO2" –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- ‚úÖ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–µ—Ä–µ–¥ –∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π (–ø—Ä–æ–≤–µ—Ç—Ä–∏—Ç—å 5-10 –º–∏–Ω)
- ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º

MQTT:
- ‚úÖ –ö–æ–º–∞–Ω–¥–∞ `calibrate` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `target_co2`

### v2.1.1 ‚Äî 2025-12-11
**Real Data Always**

–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:
- ‚úÖ –£–±—Ä–∞–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–∫–∞—á–∫–æ–≤ CO2 (–±—ã–ª–∞ 500 ppm) ‚Äî —Ç–µ–ø–µ—Ä—å —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤—Å–µ–≥–¥–∞
- ‚úÖ SCD41 –∏–º–µ–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–µ –Ω—É–∂–Ω–∞
- ‚úÖ –î–∏—Å–ø–ª–µ–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "SENSOR ERROR" –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç
- ‚úÖ –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ/—Å—Ç–∞—Ä—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

### v2.1.0 ‚Äî 2025-12-11
**Smart Polling + Live Mode + Display Control**

–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:
- ‚úÖ **Smart polling**: –¥–∏—Å–ø–ª–µ–π –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫, MQTT –ø–æ send_interval
- ‚úÖ –û–¥–∏–Ω –≤—ã–∑–æ–≤ `sensor.read()` –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç –∏ –¥–∏—Å–ø–ª–µ–π, –∏ MQTT
- ‚úÖ –ï—Å–ª–∏ –¥–∏—Å–ø–ª–µ–π –≤—ã–∫–ª—é—á–µ–Ω –∏ live mode –≤—ã–∫–ª—é—á–µ–Ω ‚Äî –æ–ø—Ä–æ—Å —Ç–æ–ª—å–∫–æ –ø–æ send_interval
- ‚úÖ **Live mode**: —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø–æ–ª—É—á–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É –∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ 5-—Å–µ–∫ –æ—Ç–ø—Ä–∞–≤–∫—É
- ‚úÖ **Display control**: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ OLED —á–µ—Ä–µ–∑ MQTT –∫–æ–º–∞–Ω–¥—ã

–ë–æ—Ç:
- ‚úÖ Live —Ä–µ–∂–∏–º: 5/10/15 –º–∏–Ω—É—Ç (–±—ã–ª–æ 5/30/60)
- ‚úÖ –ü—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ live mode –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è MQTT –∫–æ–º–∞–Ω–¥–∞ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
- ‚úÖ –ö–Ω–æ–ø–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∏—Å–ø–ª–µ–µ–º –≤ –∞–¥–º–∏–Ω–∫–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å –¥–∏—Å–ø–ª–µ—è (–í–ö–õ/–í–´–ö–õ) –≤ –∫–∞—Ä—Ç–æ—á–∫–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:
- ‚úÖ –ù–æ–≤—ã–µ –ø–æ–ª—è: `display_enabled`, `live_mode_until`
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è 0007

### v2.0.7 ‚Äî 2025-12-11
**Adaptive Display**

- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –º–∞—Å—à—Ç–∞–±: scale=7 –¥–ª—è 3 —Ü–∏—Ñ—Ä (400-999), scale=5 –¥–ª—è 4 —Ü–∏—Ñ—Ä (1000+)
- ‚úÖ –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ –∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏

### v2.0.6 ‚Äî 2025-12-11
**Big Display + SSH Tunnels**

–î–∏—Å–ø–ª–µ–π:
- ‚úÖ –ë–æ–ª—å—à–∏–µ —Ü–∏—Ñ—Ä—ã CO2 (scale=4, ~24x28px –Ω–∞ —Ü–∏—Ñ—Ä—É)
- ‚úÖ –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π –±–∞–π—Ç–æ–≤—ã–π —à—Ä–∏—Ñ—Ç (70 bytes –≤–º–µ—Å—Ç–æ —Å—Ç—Ä–æ–∫)
- ‚úÖ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã `big_text()` –∏ `big_number()`
- ‚úÖ –ê–≤—Ç–æ—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è 3-4 –∑–Ω–∞—á–Ω—ã—Ö —á–∏—Å–µ–ª

SSH:
- ‚úÖ Reverse SSH tunnel —á–µ—Ä–µ–∑ autossh
- ‚úÖ –°–∫—Ä–∏–ø—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `/tunnel-setup.sh`
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∫–ª—é—á–µ–π

### v2.0.5 ‚Äî 2025-12-11
**Fix OTA Health Check**

- ‚úÖ Health check: 5 –ø–æ–ø—ã—Ç–æ–∫ —á—Ç–µ–Ω–∏—è —Å–µ–Ω—Å–æ—Ä–∞ (–±—ã–ª–æ 2)
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –≤–µ—á–Ω—ã–π rollback –∏–∑-–∑–∞ –ø—Ä–æ–ø—É—Å–∫–∞ –ø–µ—Ä–≤—ã—Ö 2 —á—Ç–µ–Ω–∏–π SCD41

### v2.0.4 ‚Äî 2025-12-11
**Auto-download font file**

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ font5x8.bin –¥–ª—è –¥–∏—Å–ø–ª–µ—è
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ "font5x8.bin not found"

### v2.0.0 ‚Äî 2025-12-10
**OTA-—Å–∏—Å—Ç–µ–º–∞ –∏ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞—Ç—á–∏–∫–∏**

–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:
- ‚úÖ SCD41 ‚Äî —Ä–µ–∞–ª—å–Ω—ã–π –¥–∞—Ç—á–∏–∫ CO2/—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã/–≤–ª–∞–∂–Ω–æ—Å—Ç–∏ (—É–±—Ä–∞–Ω demo mode)
- ‚úÖ SSD1306 ‚Äî OLED –¥–∏—Å–ø–ª–µ–π 128x64 —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ Bootstrap loader ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ OTA –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ Health check ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ Auto rollback ‚Äî –æ—Ç–∫–∞—Ç –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â—É—é –≤–µ—Ä—Å–∏—é –ø—Ä–∏ –æ—à–∏–±–∫–µ
- ‚úÖ Exit code 100 ‚Äî —Å–∏–≥–Ω–∞–ª –¥–ª—è force_update —á–µ—Ä–µ–∑ MQTT
- ‚úÖ Venv support ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –Ω–æ–≤—ã—Ö Raspberry Pi OS (PEP 668)

–°–µ—Ä–≤–µ—Ä:
- ‚úÖ `/api/device/bootstrap` ‚Äî endpoint –¥–ª—è bootstrap.py
- ‚úÖ `/api/device/install_service` ‚Äî endpoint –¥–ª—è install_service.sh
- ‚úÖ Force Update –∫–Ω–æ–ø–∫–∞ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –±–æ—Ç–∞
- ‚úÖ `publish_device_command()` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —á–µ—Ä–µ–∑ MQTT

–£—Ä–æ–∫–∏ –∏–∑ –¥–µ–ø–ª–æ—è (—Å–º. –±—ç–∫–ª–æ–≥):
- ‚ùå –ù–µ—Ç CI/CD ‚Äî –∫–æ–¥ –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚ùå –ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- ‚ùå Health check –ø–∞–¥–∞–µ—Ç –ø—Ä–∏ –ø–µ—Ä–≤–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ

### v1.2.5
- `/live` ‚Äî —Ä–µ–∂–∏–º —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫
- `/history` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –ø–æ–∫–∞–∑–∞–Ω–∏–π —Å —É—Å—Ä–µ–¥–Ω—ë–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–¥–æ 12/24 –∑–∞–ø–∏—Å–µ–π)
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Å—Ç–∞—Ç—É—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (offline –µ—Å–ª–∏ –ø—Ä–æ–ø—É—â–µ–Ω–æ 3 –æ—Ç–ø—Ä–∞–≤–∫–∏)
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –¥–∞–Ω–Ω—ã—Ö ("5 –º–∏–Ω –Ω–∞–∑–∞–¥")
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –Ω–µ –≤ —Å–µ—Ç–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### v1.2.4
- –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ –º–µ–Ω—é –≤–Ω–∏–∑—É —ç–∫—Ä–∞–Ω–∞ (ReplyKeyboardMarkup —Å is_persistent)
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–º–∞–Ω–¥ –≤ –º–µ–Ω—é Telegram (set_my_commands)
- –û–±—ä–µ–¥–∏–Ω–µ–Ω—ã –∫–æ–º–∞–Ω–¥—ã –∏ –∫–Ω–æ–ø–∫–∏ –º–µ–Ω—é
- –£–¥–∞–ª–µ–Ω—ã –¥—É–±–ª–∏—Ä—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã (/morning, /evening, /menu)
- –ù–æ—á–Ω–æ–π/–î–Ω–µ–≤–Ω–æ–π –æ—Ç—á—ë—Ç –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ inline –∫–Ω–æ–ø–∫–∏ –≤ /report
- –£–ª—É—á—à–µ–Ω–Ω–æ–µ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ (–∞–≥—Ä–µ–≥–∞—Ü–∏—è + spline –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º)

### v1.2.3
- –ú–Ω–æ–≥–æ—Ü–≤–µ—Ç–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ CO2 –≤ —Å—Ç–∏–ª–µ Apple Stocks
- –¶–≤–µ—Ç –ª–∏–Ω–∏–∏ –∏ –∑–∞–ª–∏–≤–∫–∏ –º–µ–Ω—è–µ—Ç—Å—è –ø–æ —É—Ä–æ–≤–Ω—é CO2
- –ú–æ–±–∏–ª—å–Ω–æ-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã

### v1.2.2
- –ö–æ–º–∞–Ω–¥–∞ `/report` ‚Äî –ø–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç –∑–∞ 24 —á–∞—Å–∞ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–æ–π
- –£–¥–∞–ª–µ–Ω–∞ –¥—É–±–ª–∏—Ä—É—é—â–∞—è –∫–æ–º–∞–Ω–¥–∞ `/chart`
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

### v1.2.1
- –ò–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∏ (matplotlib + seaborn)
- –ö–æ–º–∞–Ω–¥—ã `/morning`, `/evening`
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π `/settings`
- –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ—Ç—á—ë—Ç–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —á–µ—Ä–µ–∑ –±–æ—Ç–∞
- MQTT push –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

### v1.2.0
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —á–∞—Å–æ–≤—ã—Ö –ø–æ—è—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Ç–∏–ø Telegram ID (BigInteger)
- MQTT_EXTERNAL_PORT –∏–∑ Infisical

### v1.1.0
- –ü—Ä–∏–≤—è–∑–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø–æ –∫–æ–¥—É –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
- OTA –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—à–∏–≤–∫–∏

### v1.0.0
- –ë–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –±–æ—Ç–∞
- MQTT —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—è
- PostgreSQL —Ö—Ä–∞–Ω–µ–Ω–∏–µ

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
